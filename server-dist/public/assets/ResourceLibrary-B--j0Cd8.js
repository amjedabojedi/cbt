import{c as js,u as fs,n as bs,y as ys,r as c,j as e,C as w,a as C,B as a,e as S,f as F,g as H,l as $e,h}from"./index-BJDVYPr2.js";import{u as Z}from"./useQuery-CVl6tFXz.js";import{u as E}from"./useMutation-4_CoT2bx.js";import{A as Ae}from"./AppLayout-B4pR-pjA.js";import{u as xe,F as pe,a as x,b as p,c as g,d as j,e as R,f as ge,z as U,t as je}from"./form-Bn3qej8w.js";import{T as Ie,a as Ge,b as O,c as fe}from"./tabs-DZkkmdmK.js";import{D as f,f as Ke,a as b,b as y,c as v,d as D,e as P}from"./dialog-BkbRhY2O.js";import{I as N}from"./input-C744jVRX.js";import{T as A}from"./textarea-8UmQ7iuL.js";import{C as L}from"./checkbox-CpzJVwUi.js";import{C as Te}from"./circle-plus-C1yyTLEf.js";import{S as Re}from"./square-pen-BwPwTV1q.js";import{T as Ue}from"./trash-2-ZtlY59XR.js";import{S as vs}from"./sparkles-aDL3aOOp.js";import{U as Ns}from"./user-check-CnUqHDMm.js";import{F as Ve}from"./file-text-CB9D2AC_.js";import{f as ws}from"./Header-HmO9KIvP.js";import"./utils-km2FGkQ4.js";import"./label-DKKVfa8V.js";import"./index-epKMAjhH.js";import"./index-ZMpGrT0S.js";import"./index-pLghM4Oe.js";import"./check-CPyQFfyd.js";import"./target-7abParum.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=js("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),Qe=U.object({name:U.string().min(2,"Name must be at least 2 characters"),description:U.string().optional(),isGlobal:U.boolean().default(!1)}),ze=U.object({name:U.string().min(2,"Name must be at least 2 characters"),description:U.string().optional(),isGlobal:U.boolean().default(!1)});function Js(){const{user:t}=fs(),{toast:l}=bs(),m=ys(),[Be,ee]=c.useState(!1),[Ye,se]=c.useState(!1),[te,re]=c.useState(null),[He,_]=c.useState(!1),[_e,ie]=c.useState(!1),[We,ae]=c.useState(!1),[ne,le]=c.useState(null),[Je,W]=c.useState(!1),[Xe,oe]=c.useState(!1);c.useState(!1);const[Oe,be]=c.useState("all"),[Ze,ce]=c.useState(!1),[es,q]=c.useState(!1),[J,X]=c.useState([]),[Le,de]=c.useState(""),[r,o]=c.useState(null),[d,ss]=c.useState(null),[ts,me]=c.useState(!1),rs=["all","CBT Basics","Anxiety","Depression","Stress Management","Mindfulness","Emotional Regulation","Relationships","Trauma","Self Care"],M=xe({resolver:je(Qe),defaultValues:{name:"",description:"",isGlobal:!1}}),$=xe({resolver:je(ze),defaultValues:{name:"",description:"",isGlobal:!1}}),I=xe({resolver:je(Qe),defaultValues:{name:"",description:"",isGlobal:!1}}),G=xe({resolver:je(ze),defaultValues:{name:"",description:"",isGlobal:!1}}),{data:K,isLoading:is,error:as}=Z({queryKey:t?[`/api/users/${t.id}/protective-factors`]:[],enabled:!!t}),{data:V,isLoading:ns,error:ls}=Z({queryKey:t?[`/api/users/${t.id}/coping-strategies`]:[],enabled:!!t}),{data:k,isLoading:os,error:Es}=Z({queryKey:["/api/resources"],enabled:!!t}),{data:ye,isLoading:cs,error:Ss}=Z({queryKey:["/api/users/clients"],enabled:!!t&&t.role==="therapist"}),ve=E({mutationFn:async s=>{if(!t)throw new Error("User not authenticated");return(await h("POST",`/api/users/${t.id}/protective-factors`,{...s,userId:t.id})).json()},onSuccess:()=>{m.invalidateQueries({queryKey:[`/api/users/${t.id}/protective-factors`]}),ee(!1),M.reset(),l({title:"Protective Factor Added",description:"Your protective factor has been added to your library."})},onError:s=>{console.error("Error creating protective factor:",s),l({title:"Error",description:"Failed to add protective factor. Please try again.",variant:"destructive"})}}),Ne=E({mutationFn:async s=>{if(!t)throw new Error("User not authenticated");return(await h("POST",`/api/users/${t.id}/coping-strategies`,{...s,userId:t.id})).json()},onSuccess:()=>{m.invalidateQueries({queryKey:[`/api/users/${t.id}/coping-strategies`]}),ie(!1),$.reset(),l({title:"Coping Strategy Added",description:"Your coping strategy has been added to your library."})},onError:s=>{console.error("Error creating coping strategy:",s),l({title:"Error",description:"Failed to add coping strategy. Please try again.",variant:"destructive"})}}),we=E({mutationFn:async s=>{if(!t)throw new Error("User not authenticated");const i=await h("DELETE",`/api/users/${t.id}/protective-factors/${s}`,null);if(!i.ok){const n=await i.json();throw new Error(n.message||"Failed to delete protective factor")}return i.json()},onSuccess:()=>{m.invalidateQueries({queryKey:[`/api/users/${t.id}/protective-factors`]}),re(null),_(!1),l({title:"Protective Factor Deleted",description:"The protective factor has been removed from your library."})},onError:s=>{console.error("Error deleting protective factor:",s),l({title:"Error",description:"Failed to delete protective factor. Please try again.",variant:"destructive"})}}),Ce=E({mutationFn:async s=>{if(!t)throw new Error("User not authenticated");const i=await h("DELETE",`/api/users/${t.id}/coping-strategies/${s}`,null);if(!i.ok){const n=await i.json();throw new Error(n.message||"Failed to delete coping strategy")}return i.json()},onSuccess:()=>{m.invalidateQueries({queryKey:[`/api/users/${t.id}/coping-strategies`]}),le(null),W(!1),l({title:"Coping Strategy Deleted",description:"The coping strategy has been removed from your library."})},onError:s=>{console.error("Error deleting coping strategy:",s),l({title:"Error",description:"Failed to delete coping strategy. Please try again.",variant:"destructive"})}}),Ee=E({mutationFn:async({id:s,data:i})=>{if(!t)throw new Error("User not authenticated");const n=await h("PUT",`/api/users/${t.id}/protective-factors/${s}`,i);if(!n.ok){const u=await n.json();throw new Error(u.message||"Failed to update protective factor")}return n.json()},onSuccess:()=>{m.invalidateQueries({queryKey:[`/api/users/${t.id}/protective-factors`]}),se(!1),re(null),l({title:"Protective Factor Updated",description:"Your protective factor has been updated."})},onError:s=>{console.error("Error updating protective factor:",s),l({title:"Error",description:"Failed to update protective factor. Please try again.",variant:"destructive"})}}),Se=E({mutationFn:async({id:s,data:i})=>{if(!t)throw new Error("User not authenticated");const n=await h("PUT",`/api/users/${t.id}/coping-strategies/${s}`,i);if(!n.ok){const u=await n.json();throw new Error(u.message||"Failed to update coping strategy")}return n.json()},onSuccess:()=>{m.invalidateQueries({queryKey:[`/api/users/${t.id}/coping-strategies`]}),ae(!1),le(null),l({title:"Coping Strategy Updated",description:"Your coping strategy has been updated."})},onError:s=>{console.error("Error updating coping strategy:",s),l({title:"Error",description:"Failed to update coping strategy. Please try again.",variant:"destructive"})}}),Fe=E({mutationFn:async s=>{if(!t)throw new Error("User not authenticated");return(await h("POST","/api/resources",s)).json()},onSuccess:()=>{m.invalidateQueries({queryKey:["/api/resources"]}),oe(!1),l({title:"Resource Added",description:"Your educational resource has been added to the library."})},onError:s=>{console.error("Error creating resource:",s),l({title:"Error",description:"Failed to add educational resource. Please try again.",variant:"destructive"})}}),Q=E({mutationFn:async s=>{if(!t)throw new Error("User not authenticated");const i=await h("DELETE",`/api/resources/${s}`,null);if(i.status===404)return{success:!0};if(!i.ok){const n=await i.json().catch(()=>({message:"Failed to delete resource"}));throw new Error(n.message||"Failed to delete resource")}return i.status===204?{success:!0}:i.json().catch(()=>({success:!0}))},onSuccess:()=>{m.invalidateQueries({queryKey:["/api/resources"]}),o(null),q(!1),l({title:"Resource Deleted",description:"The educational resource has been removed from the library."})},onError:s=>{if(console.error("Error deleting resource:",s),s.message==="Resource not found"){m.invalidateQueries({queryKey:["/api/resources"]}),o(null),q(!1),l({title:"Resource Deleted",description:"The educational resource has been removed from the library."});return}l({title:"Error",description:"Failed to delete resource. Please try again.",variant:"destructive"})}}),ke=E({mutationFn:async({id:s,data:i})=>{if(!t)throw new Error("User not authenticated");const n=await h("PATCH",`/api/resources/${s}`,i);if(!n.ok){const u=await n.json();throw new Error(u.message||"Failed to update resource")}return n.json()},onSuccess:()=>{m.invalidateQueries({queryKey:["/api/resources"]}),r&&o({...r,isEditing:!1}),l({title:"Resource Updated",description:"The educational resource has been updated."})},onError:s=>{console.error("Error updating resource:",s),l({title:"Error",description:"Failed to update resource. Please try again.",variant:"destructive"})}}),qe=E({mutationFn:async({resourceId:s,clientIds:i,notes:n})=>{if(!t)throw new Error("User not authenticated");if(i.length===0)throw new Error("Please select at least one client");const u=i.map(T=>h("POST","/api/resources/assign",{resourceId:s,clientId:T,notes:n})),Y=await Promise.all(u);for(const T of Y)if(!T.ok){const Pe=await T.json();throw new Error(Pe.message||"Failed to assign resource to one or more clients")}return Y.map(T=>T.json())},onSuccess:()=>{m.invalidateQueries({queryKey:["/api/therapist/assignments"]}),ce(!1),X([]),de(""),o(null),l({title:"Resource Assigned",description:"The resource has been assigned to the selected client(s)."})},onError:s=>{console.error("Error assigning resource:",s),l({title:"Error",description:s instanceof Error?s.message:"Failed to assign resource. Please try again.",variant:"destructive"})}}),De=E({mutationFn:async s=>{if(!t)throw new Error("User not authenticated");const i=await h("POST",`/api/resources/${s}/clone`,null);if(!i.ok){const n=await i.json();throw new Error(n.message||"Failed to clone resource")}return i.json()},onSuccess:()=>{m.invalidateQueries({queryKey:["/api/resources"]}),l({title:"Resource Cloned",description:"You can now customize this resource before assigning it to clients."})},onError:s=>{console.error("Error cloning resource:",s),l({title:"Error",description:"Failed to clone resource. Please try again.",variant:"destructive"})}}),{data:Me=[],isLoading:ds}=Z({queryKey:["/api/therapist/assignments"],enabled:!!t&&t.role==="therapist"}),ms=s=>{ve.mutate(s)},us=s=>{Ne.mutate(s)},hs=s=>{te&&Ee.mutate({id:te.id,data:s})},xs=s=>{ne&&Se.mutate({id:ne.id,data:s})},ps=s=>{re(s),I.reset({name:s.name,description:s.description||"",isGlobal:s.isGlobal}),se(!0)},gs=s=>{le(s),G.reset({name:s.name,description:s.description||"",isGlobal:s.isGlobal}),ae(!0)},z=K==null?void 0:K.filter(s=>!s.isGlobal||s.userId===(t==null?void 0:t.id)),ue=K==null?void 0:K.filter(s=>s.isGlobal&&s.userId!==(t==null?void 0:t.id)),B=V==null?void 0:V.filter(s=>!s.isGlobal||s.userId===(t==null?void 0:t.id)),he=V==null?void 0:V.filter(s=>s.isGlobal&&s.userId!==(t==null?void 0:t.id));return is||ns?e.jsx(Ae,{title:"Resource Library",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})})})}):as||ls?e.jsx(Ae,{title:"Resource Library",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsx(w,{children:e.jsx(C,{className:"pt-6",children:e.jsx("p",{className:"text-center text-red-500",children:"Error loading resources. Please try again later."})})})})}):e.jsxs(Ae,{title:"Resource Library",children:[e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs(Ie,{defaultValue:"protective-factors",children:[e.jsxs(Ge,{className:"mb-6",children:[e.jsx(O,{value:"protective-factors",children:"Protective Factors"}),e.jsx(O,{value:"coping-strategies",children:"Coping Strategies"}),e.jsx(O,{value:"educational-resources",children:"Educational Resources"}),(t==null?void 0:t.role)==="therapist"&&e.jsx(O,{value:"client-assignments",children:"Client Assignments"})]}),e.jsxs(fe,{value:"protective-factors",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-800",children:"Protective Factors"}),e.jsx("p",{className:"text-neutral-500",children:"Elements in your life that contribute to resilience and wellbeing"})]}),e.jsxs(f,{open:Be,onOpenChange:ee,children:[e.jsx(Ke,{asChild:!0,children:e.jsxs(a,{children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add New Factor"]})}),e.jsxs(b,{children:[e.jsxs(y,{children:[e.jsx(v,{children:"Add a Protective Factor"}),e.jsx(D,{children:"Protective factors are personal strengths or resources that help you overcome challenges"})]}),e.jsx(pe,{...M,children:e.jsxs("form",{onSubmit:M.handleSubmit(ms),className:"space-y-4",children:[e.jsx(x,{control:M.control,name:"name",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Name"}),e.jsx(j,{children:e.jsx(N,{placeholder:"E.g., Supportive relationships",...s})}),e.jsx(R,{})]})}),e.jsx(x,{control:M.control,name:"description",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Description (Optional)"}),e.jsx(j,{children:e.jsx(A,{placeholder:"Add more details about this protective factor...",rows:3,...s})}),e.jsx(R,{})]})}),(t==null?void 0:t.role)==="therapist"&&e.jsx(x,{control:M.control,name:"isGlobal",render:({field:s})=>e.jsxs(p,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(j,{children:e.jsx(L,{checked:s.value,onCheckedChange:s.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(g,{children:"Share with all clients"}),e.jsx(ge,{children:"This will make the protective factor available to all your clients"})]})]})}),e.jsxs(P,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>ee(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:ve.isPending,children:ve.isPending?"Adding...":"Add Factor"})]})]})})]})]}),e.jsx(f,{open:Ye,onOpenChange:se,children:e.jsxs(b,{children:[e.jsxs(y,{children:[e.jsx(v,{children:"Edit Protective Factor"}),e.jsx(D,{children:"Update your protective factor details"})]}),e.jsx(pe,{...I,children:e.jsxs("form",{onSubmit:I.handleSubmit(hs),className:"space-y-4",children:[e.jsx(x,{control:I.control,name:"name",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Name"}),e.jsx(j,{children:e.jsx(N,{placeholder:"E.g., Supportive relationships",...s})}),e.jsx(R,{})]})}),e.jsx(x,{control:I.control,name:"description",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Description (Optional)"}),e.jsx(j,{children:e.jsx(A,{placeholder:"Add more details about this protective factor...",rows:3,...s})}),e.jsx(R,{})]})}),(t==null?void 0:t.role)==="therapist"&&e.jsx(x,{control:I.control,name:"isGlobal",render:({field:s})=>e.jsxs(p,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(j,{children:e.jsx(L,{checked:s.value,onCheckedChange:s.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(g,{children:"Share with all clients"}),e.jsx(ge,{children:"This will make the protective factor available to all your clients"})]})]})}),e.jsxs(P,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>se(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:Ee.isPending,children:Ee.isPending?"Updating...":"Update Factor"})]})]})})]})})]}),e.jsxs(w,{className:"mb-6",children:[e.jsxs(S,{children:[e.jsx(F,{className:"text-lg",children:"My Protective Factors"}),e.jsx(H,{children:"Factors you've personally identified or created"})]}),e.jsx(C,{children:(z==null?void 0:z.length)===0?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary/10 text-primary mb-4",children:e.jsx(Cs,{className:"h-6 w-6"})}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No personal protective factors yet"}),e.jsx("p",{className:"text-neutral-500 max-w-md mx-auto mb-6",children:"Add your personal protective factors to help identify strengths you can rely on during difficult times."}),e.jsx(a,{onClick:()=>ee(!0),children:"Add Your First Protective Factor"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:z==null?void 0:z.map(s=>e.jsxs(w,{className:"overflow-hidden border border-neutral-200 hover:shadow-md transition-shadow",children:[e.jsx(S,{className:"bg-neutral-50 p-4 pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(F,{className:"text-base font-medium",children:s.name}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(a,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ps(s),children:e.jsx(Re,{className:"h-4 w-4 text-neutral-500"})}),e.jsx(a,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive/90",onClick:()=>{re(s),_(!0)},children:e.jsx(Ue,{className:"h-4 w-4"})})]})]})}),e.jsx(C,{className:"p-4 pt-2",children:e.jsx("p",{className:"text-sm text-neutral-600",children:s.description||"No description provided."})})]},s.id))})})]}),(ue==null?void 0:ue.length)>0&&e.jsxs(w,{children:[e.jsxs(S,{children:[e.jsx(F,{className:"text-lg",children:"Shared Protective Factors"}),e.jsx(H,{children:(t==null?void 0:t.role)==="therapist"?"Factors shared by other therapists":"Factors shared by your therapist"})]}),e.jsx(C,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ue.map(s=>e.jsxs(w,{className:"overflow-hidden border border-neutral-200 hover:shadow-md transition-shadow",children:[e.jsx(S,{className:"bg-neutral-50 p-4 pb-3",children:e.jsx(F,{className:"text-base font-medium",children:s.name})}),e.jsx(C,{className:"p-4 pt-2",children:e.jsx("p",{className:"text-sm text-neutral-600",children:s.description||"No description provided."})})]},s.id))})})]}),e.jsx(f,{open:He,onOpenChange:_,children:e.jsxs(b,{children:[e.jsxs(y,{children:[e.jsx(v,{children:"Delete Protective Factor"}),e.jsx("div",{className:"pt-2 text-sm text-muted-foreground",children:"Are you sure you want to delete this protective factor? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(a,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>{te&&(we.mutate(te.id),_(!1))},disabled:we.isPending,children:we.isPending?"Deleting...":"Delete Factor"})]})]})})]}),e.jsxs(fe,{value:"coping-strategies",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-800",children:"Coping Strategies"}),e.jsx("p",{className:"text-neutral-500",children:"Techniques and approaches to manage stress and difficult emotions"})]}),e.jsxs(f,{open:_e,onOpenChange:ie,children:[e.jsx(Ke,{asChild:!0,children:e.jsxs(a,{children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add New Strategy"]})}),e.jsxs(b,{children:[e.jsxs(y,{children:[e.jsx(v,{children:"Add a Coping Strategy"}),e.jsx(D,{children:"Coping strategies help you deal with stress, anxiety, and other difficult emotions"})]}),e.jsx(pe,{...$,children:e.jsxs("form",{onSubmit:$.handleSubmit(us),className:"space-y-4",children:[e.jsx(x,{control:$.control,name:"name",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Name"}),e.jsx(j,{children:e.jsx(N,{placeholder:"E.g., Deep breathing exercises",...s})}),e.jsx(R,{})]})}),e.jsx(x,{control:$.control,name:"description",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Description (Optional)"}),e.jsx(j,{children:e.jsx(A,{placeholder:"Add more details about this coping strategy...",rows:3,...s})}),e.jsx(R,{})]})}),(t==null?void 0:t.role)==="therapist"&&e.jsx(x,{control:$.control,name:"isGlobal",render:({field:s})=>e.jsxs(p,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(j,{children:e.jsx(L,{checked:s.value,onCheckedChange:s.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(g,{children:"Share with all clients"}),e.jsx(ge,{children:"This will make the coping strategy available to all your clients"})]})]})}),e.jsxs(P,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>ie(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:Ne.isPending,children:Ne.isPending?"Adding...":"Add Strategy"})]})]})})]})]}),e.jsx(f,{open:We,onOpenChange:ae,children:e.jsxs(b,{children:[e.jsxs(y,{children:[e.jsx(v,{children:"Edit Coping Strategy"}),e.jsx(D,{children:"Update your coping strategy details"})]}),e.jsx(pe,{...G,children:e.jsxs("form",{onSubmit:G.handleSubmit(xs),className:"space-y-4",children:[e.jsx(x,{control:G.control,name:"name",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Name"}),e.jsx(j,{children:e.jsx(N,{placeholder:"E.g., Deep breathing exercises",...s})}),e.jsx(R,{})]})}),e.jsx(x,{control:G.control,name:"description",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Description (Optional)"}),e.jsx(j,{children:e.jsx(A,{placeholder:"Add more details about this coping strategy...",rows:3,...s})}),e.jsx(R,{})]})}),(t==null?void 0:t.role)==="therapist"&&e.jsx(x,{control:G.control,name:"isGlobal",render:({field:s})=>e.jsxs(p,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(j,{children:e.jsx(L,{checked:s.value,onCheckedChange:s.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(g,{children:"Share with all clients"}),e.jsx(ge,{children:"This will make the coping strategy available to all your clients"})]})]})}),e.jsxs(P,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>ae(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:Se.isPending,children:Se.isPending?"Updating...":"Update Strategy"})]})]})})]})})]}),e.jsxs(w,{className:"mb-6",children:[e.jsxs(S,{children:[e.jsx(F,{className:"text-lg",children:"My Coping Strategies"}),e.jsx(H,{children:"Strategies you've personally identified or created"})]}),e.jsx(C,{children:(B==null?void 0:B.length)===0?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary/10 text-primary mb-4",children:e.jsx(vs,{className:"h-6 w-6"})}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No personal coping strategies yet"}),e.jsx("p",{className:"text-neutral-500 max-w-md mx-auto mb-6",children:"Add your personal coping strategies to build a toolkit for managing difficult situations."}),e.jsx(a,{onClick:()=>ie(!0),children:"Add Your First Coping Strategy"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:B==null?void 0:B.map(s=>e.jsxs(w,{className:"overflow-hidden border border-neutral-200 hover:shadow-md transition-shadow",children:[e.jsx(S,{className:"bg-neutral-50 p-4 pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(F,{className:"text-base font-medium",children:s.name}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(a,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>gs(s),children:e.jsx(Re,{className:"h-4 w-4 text-neutral-500"})}),e.jsx(a,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive/90",onClick:()=>{le(s),W(!0)},children:e.jsx(Ue,{className:"h-4 w-4"})})]})]})}),e.jsx(C,{className:"p-4 pt-2",children:e.jsx("p",{className:"text-sm text-neutral-600",children:s.description||"No description provided."})})]},s.id))})})]}),(he==null?void 0:he.length)>0&&e.jsxs(w,{children:[e.jsxs(S,{children:[e.jsx(F,{className:"text-lg",children:"Shared Coping Strategies"}),e.jsx(H,{children:(t==null?void 0:t.role)==="therapist"?"Strategies shared by other therapists":"Strategies shared by your therapist"})]}),e.jsx(C,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:he.map(s=>e.jsxs(w,{className:"overflow-hidden border border-neutral-200 hover:shadow-md transition-shadow",children:[e.jsx(S,{className:"bg-neutral-50 p-4 pb-3",children:e.jsx(F,{className:"text-base font-medium",children:s.name})}),e.jsx(C,{className:"p-4 pt-2",children:e.jsx("p",{className:"text-sm text-neutral-600",children:s.description||"No description provided."})})]},s.id))})})]}),e.jsx(f,{open:Je,onOpenChange:W,children:e.jsxs(b,{children:[e.jsxs(y,{children:[e.jsx(v,{children:"Delete Coping Strategy"}),e.jsx("div",{className:"pt-2 text-sm text-muted-foreground",children:"Are you sure you want to delete this coping strategy? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(a,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>{ne&&(Ce.mutate(ne.id),W(!1))},disabled:Ce.isPending,children:Ce.isPending?"Deleting...":"Delete Strategy"})]})]})}),e.jsx(f,{open:es,onOpenChange:q,children:e.jsxs(b,{children:[e.jsxs(y,{children:[e.jsx(v,{children:"Delete Educational Resource"}),e.jsx("div",{className:"pt-2 text-sm text-muted-foreground",children:"Are you sure you want to delete this educational resource? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(a,{variant:"outline",onClick:()=>q(!1),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>{r&&(Q.mutate(r.id),q(!1))},disabled:Q.isPending,children:Q.isPending?"Deleting...":"Delete Resource"})]})]})})]}),e.jsxs(fe,{value:"educational-resources",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-800",children:"Educational Resources"}),e.jsx("p",{className:"text-neutral-500",children:"Materials to help you learn about mental health concepts and techniques"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="therapist")&&e.jsxs(a,{onClick:()=>oe(!0),children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add Resource"]})]}),e.jsx(Ie,{defaultValue:"all",className:"mb-6",children:e.jsxs(Ge,{className:"mb-6 flex flex-wrap h-auto p-1",children:[e.jsx(O,{value:"all",onClick:()=>be("all"),className:"capitalize",children:"All Categories"},"all"),k&&[...new Set(k.map(s=>s.category))].filter(s=>s&&s!=="all").map(s=>e.jsx(O,{value:s,onClick:()=>be(s),children:s},s)),rs.filter(s=>s!=="all"&&(!k||!k.some(i=>i.category===s))).map(s=>e.jsx(O,{value:s,onClick:()=>be(s),children:s},s))]})}),os?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:k==null?void 0:k.filter(s=>Oe==="all"||s.category===Oe).map(s=>e.jsxs(w,{className:"overflow-hidden flex flex-col h-full transition-shadow hover:shadow-md",children:[e.jsxs(S,{className:"bg-neutral-50 pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(F,{className:"text-lg font-medium",children:s.title}),(s.createdBy===(t==null?void 0:t.id)||(t==null?void 0:t.role)==="admin")&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(a,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>o({...s,isEditing:!0}),children:e.jsx(Re,{className:"h-4 w-4 text-neutral-500"})}),(t==null?void 0:t.role)==="admin"&&s.createdBy!==(t==null?void 0:t.id)&&e.jsx(a,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 hover:text-red-700 hover:bg-red-50",onClick:()=>{o(s),q(!0)},children:e.jsx(Ue,{className:"h-4 w-4"})})]})]}),e.jsxs(H,{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10",children:s.type.charAt(0).toUpperCase()+s.type.slice(1)}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-700/10",children:s.category})]})]}),e.jsx(C,{className:"pb-2 flex-grow",children:e.jsx("p",{className:"text-sm text-neutral-600",children:s.description})}),e.jsxs($e,{className:"flex justify-between",children:[e.jsx(a,{variant:"outline",size:"sm",onClick:()=>o({...s,isEditing:!1}),children:"View Resource"}),(t==null?void 0:t.role)==="therapist"&&e.jsxs(a,{variant:"default",size:"sm",onClick:()=>{o(s),ce(!0)},children:[e.jsx(Ns,{className:"mr-1 h-4 w-4"}),"Assign to Client"]})]})]},s.id))}),r&&!r.isEditing&&e.jsx(f,{open:!!r,onOpenChange:s=>!s&&o(null),children:e.jsxs(b,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(y,{children:[e.jsx(v,{children:r.title}),e.jsx(D,{children:e.jsxs("div",{className:"flex space-x-2 mt-1",children:[e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10",children:r.type.charAt(0).toUpperCase()+r.type.slice(1)}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-700/10",children:r.category})]})})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Description"}),e.jsx("p",{className:"text-neutral-700",children:r.description})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Content"}),e.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:r.content}})]}),r.pdfUrl&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Attached PDF"}),e.jsx(a,{asChild:!0,children:e.jsxs("a",{href:r.pdfUrl,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Ve,{className:"mr-2 h-4 w-4"}),"View PDF"]})})]}),r.tags&&r.tags.length>0&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map((s,i)=>e.jsx("span",{className:"inline-flex items-center rounded-full bg-neutral-100 px-2 py-1 text-xs font-medium text-neutral-700",children:s},i))})]})]}),e.jsxs(P,{className:"border-t mt-6 pt-4 flex justify-between",children:[e.jsx("div",{className:"flex gap-2",children:(r.createdBy===(t==null?void 0:t.id)||(t==null?void 0:t.role)==="admin")&&e.jsx(a,{variant:"destructive",onClick:()=>{Q.mutate(r.id)},disabled:Q.isPending,children:Q.isPending?"Deleting...":"Delete Resource"})}),e.jsxs("div",{className:"flex gap-2",children:[(r.createdBy===(t==null?void 0:t.id)||(t==null?void 0:t.role)==="admin")&&e.jsx(a,{onClick:()=>o({...r,isEditing:!0}),children:"Edit Resource"}),(t==null?void 0:t.role)==="therapist"&&r.createdBy!==(t==null?void 0:t.id)&&e.jsx(a,{onClick:()=>{De.mutate(r.id),o(null)},disabled:De.isPending,children:De.isPending?"Cloning...":"Clone to My Resources"})]})]})]})}),r&&r.isEditing&&e.jsx(f,{open:!!r,onOpenChange:s=>!s&&o(null),children:e.jsxs(b,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(y,{children:[e.jsx(v,{children:"Edit Resource"}),e.jsx(D,{children:"Update this educational resource"})]}),e.jsxs("form",{onSubmit:s=>{if(s.preventDefault(),r){const i={title:r.title,description:r.description,content:r.content,type:r.type,category:r.category,tags:r.tags||[],isPublished:r.isPublished,pdfUrl:r.pdfUrl};ke.mutate({id:r.id,data:i})}},className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Title"}),e.jsx(N,{value:r.title,onChange:s=>o({...r,title:s.target.value}),placeholder:"Enter title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Category"}),e.jsx("div",{className:"relative",children:e.jsx(N,{value:r.category,onChange:s=>{const i=s.target.value.trim();i&&o({...r,category:i})},placeholder:"Enter your custom category name"})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Type the name of your custom category"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Description"}),e.jsx(A,{value:r.description,onChange:s=>o({...r,description:s.target.value}),placeholder:"Enter a brief description",rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Content"}),e.jsx(A,{value:r.content,onChange:s=>o({...r,content:s.target.value}),placeholder:"Enter the main content (supports HTML for formatting)",rows:8})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Resource Type"}),e.jsxs("select",{value:r.type,onChange:s=>o({...r,type:s.target.value}),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"article",children:"Article"}),e.jsx("option",{value:"worksheet",children:"Worksheet"}),e.jsx("option",{value:"guide",children:"Guide"}),e.jsx("option",{value:"exercise",children:"Exercise"}),e.jsx("option",{value:"video",children:"Video"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"PDF URL (Optional)"}),e.jsx(N,{value:r.pdfUrl||"",onChange:s=>o({...r,pdfUrl:s.target.value}),placeholder:"https://example.com/document.pdf"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Tags (comma-separated)"}),e.jsx(N,{value:(r.tags||[]).join(", "),onChange:s=>{const n=s.target.value.split(",").map(u=>u.trim()).filter(Boolean);o({...r,tags:n})},placeholder:"anxiety, relaxation, mindfulness"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{id:"published",checked:r.isPublished,onCheckedChange:s=>o({...r,isPublished:!!s})}),e.jsx("label",{htmlFor:"published",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Published (visible to others)"})]})]}),e.jsxs(P,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>o({...r,isEditing:!1}),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:ke.isPending,children:ke.isPending?"Saving...":"Save Changes"})]})]})]})}),e.jsx(f,{open:Ze,onOpenChange:s=>{s||(ce(!1),X([]),de(""))},children:e.jsxs(b,{className:"max-w-md",children:[e.jsxs(y,{children:[e.jsx(v,{children:"Assign Resource to Clients"}),e.jsx(D,{children:"Select the clients you want to assign this resource to"})]}),cs?e.jsx("div",{className:"py-6 flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-primary"})}):ye&&ye.length>0?e.jsxs("div",{className:"py-2 space-y-4",children:[e.jsx("div",{className:"border rounded-md p-3 space-y-3",children:ye.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{id:`client-${s.id}`,checked:J.includes(s.id),onCheckedChange:i=>{X(i?[...J,s.id]:J.filter(n=>n!==s.id))}}),e.jsx("label",{htmlFor:`client-${s.id}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:s.name||s.username})]},s.id))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium leading-none",children:"Notes for Client (Optional)"}),e.jsx(A,{placeholder:"Add instructions or context for this resource...",value:Le,onChange:s=>de(s.target.value),rows:3})]})]}):e.jsx("div",{className:"py-6 text-center text-muted-foreground",children:e.jsx("p",{children:"You don't have any clients to assign resources to."})}),e.jsxs(P,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>{ce(!1),X([]),de("")},children:"Cancel"}),e.jsx(a,{type:"button",disabled:J.length===0||!r,onClick:()=>{r&&qe.mutate({resourceId:r.id,clientIds:J,notes:Le})},children:qe.isPending?"Assigning...":"Assign Resource"})]})]})}),e.jsx(f,{open:Xe,onOpenChange:oe,children:e.jsxs(b,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(y,{children:[e.jsx(v,{children:"Add Educational Resource"}),e.jsx(D,{children:"Create a new resource to share knowledge with clients"})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault();const i=new FormData(s.currentTarget),n=i.get("category"),u=i.get("custom-category");let Y="other";n&&n.trim()?Y=n.trim():u&&u.trim()&&(Y=u.trim());const T={title:i.get("title"),description:i.get("description"),content:i.get("content"),type:i.get("type"),category:Y,tags:i.get("tags")?i.get("tags").split(",").map(Pe=>Pe.trim()):[],isPublished:i.get("published")==="on",pdfUrl:i.get("pdfUrl")||void 0,createdBy:t==null?void 0:t.id};Fe.mutate(T)},className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"title",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Title"}),e.jsx(N,{id:"title",name:"title",placeholder:"Enter title",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"category",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Category"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("select",{id:"category",name:"category",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"",children:"-- Select a Category --"}),k&&[...new Set(k.map(s=>s.category))].filter(s=>s&&s!=="all").map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("div",{className:"relative",children:e.jsx(N,{id:"custom-category",name:"custom-category",placeholder:"Or enter a new category name",defaultValue:""})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select an existing category or create a new one"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"description",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Description"}),e.jsx(A,{id:"description",name:"description",placeholder:"Enter a brief description",rows:2,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"content",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Content"}),e.jsx(A,{id:"content",name:"content",placeholder:"Enter the main content (supports HTML for formatting)",rows:8,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"type",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Resource Type"}),e.jsxs("select",{id:"type",name:"type",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:[e.jsx("option",{value:"article",children:"Article"}),e.jsx("option",{value:"worksheet",children:"Worksheet"}),e.jsx("option",{value:"guide",children:"Guide"}),e.jsx("option",{value:"exercise",children:"Exercise"}),e.jsx("option",{value:"video",children:"Video"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"pdfUrl",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"PDF URL (Optional)"}),e.jsx(N,{id:"pdfUrl",name:"pdfUrl",placeholder:"https://example.com/document.pdf"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"tags",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Tags (comma-separated)"}),e.jsx(N,{id:"tags",name:"tags",placeholder:"anxiety, relaxation, mindfulness"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{id:"published",name:"published",defaultChecked:!0}),e.jsx("label",{htmlFor:"published",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Published (visible to others)"})]})]}),e.jsxs(P,{children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>oe(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:Fe.isPending,children:Fe.isPending?"Creating...":"Create Resource"})]})]})]})})]}),(t==null?void 0:t.role)==="therapist"&&e.jsxs(fe,{value:"client-assignments",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-800",children:"Client Assignments"}),e.jsx("p",{className:"text-neutral-500",children:"View and manage resources assigned to your clients"})]})}),ds?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):Me.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Me.map(s=>e.jsxs(w,{className:"overflow-hidden",children:[e.jsx(S,{className:"bg-neutral-50 p-4 pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(F,{className:"text-lg",children:s.resource.title}),e.jsxs(H,{children:["Assigned to: ",s.client&&(s.client.name||s.client.username)||"Client information unavailable"]})]}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10",children:s.status})]})}),e.jsxs(C,{className:"p-4 pt-3",children:[e.jsx("p",{className:"text-sm text-neutral-600 line-clamp-2",children:s.resource.description}),s.notes&&e.jsxs("div",{className:"mt-3 p-2 bg-neutral-50 rounded-md border text-sm",children:[e.jsx("p",{className:"font-medium text-xs text-neutral-500 mb-1",children:"Your notes:"}),e.jsx("p",{className:"text-neutral-700",children:s.notes})]})]}),e.jsx($e,{className:"p-4 pt-2 flex justify-between",children:e.jsx(a,{variant:"outline",size:"sm",onClick:()=>{ss(s),me(!0)},children:"View Details"})})]},s.id))}):e.jsxs("div",{className:"text-center p-8 border rounded-md bg-neutral-50",children:[e.jsx(ws,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No assignments yet"}),e.jsx("p",{className:"text-neutral-500 mb-4",children:"You haven't assigned any resources to your clients yet."}),e.jsx(a,{onClick:()=>{const s=document.querySelector('button[value="educational-resources"]');s&&s.click()},children:"Browse Resources"})]})]})]})}),e.jsx(f,{open:ts,onOpenChange:me,children:e.jsx(b,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:d&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{children:[e.jsx(v,{className:"text-2xl font-bold",children:"Assignment Details"}),e.jsx(D,{children:"View details about this resource assignment"})]}),e.jsxs("div",{className:"my-4 p-4 bg-neutral-50 rounded-md border",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:d.resource.title}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10",children:d.status})]}),e.jsx("p",{className:"text-sm text-neutral-600 mb-4",children:d.resource.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:"Assigned To"}),e.jsx("p",{className:"text-sm font-medium",children:d.client&&(d.client.name||d.client.username)||"Client information unavailable"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:"Assigned On"}),e.jsx("p",{className:"text-sm",children:new Date(d.assignedAt).toLocaleDateString()})]})]}),d.notes&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:"Your Notes"}),e.jsx("div",{className:"p-3 bg-white rounded border",children:e.jsx("p",{className:"text-sm",children:d.notes})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:"Resource Category"}),e.jsx("div",{className:"flex",children:e.jsx("span",{className:"inline-flex items-center rounded-full bg-neutral-100 px-2 py-1 text-xs font-medium text-neutral-700",children:d.resource.category})})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-2",children:"Resource Content"}),e.jsx("div",{className:"bg-white border rounded-md p-4 max-h-[40vh] overflow-y-auto",children:d.resource.type==="article"?e.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:d.resource.content}}):d.resource.type==="pdf"&&d.resource.fileUrl?e.jsx("div",{className:"text-center",children:e.jsxs("a",{href:d.resource.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-blue-600 hover:text-blue-800",children:[e.jsx(Ve,{className:"h-5 w-5 mr-2"}),"Open PDF in new tab"]})}):e.jsx("p",{className:"text-neutral-500 italic",children:"No preview available"})})]})]}),e.jsxs(P,{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(a,{variant:"outline",onClick:()=>me(!1),children:"Close"})}),e.jsx("div",{className:"flex gap-2",children:e.jsx(a,{variant:"destructive",onClick:async()=>{try{await h("DELETE",`/api/resource-assignments/${d.id}`,null),m.invalidateQueries({queryKey:["/api/therapist/assignments"]}),me(!1),l({title:"Assignment Deleted",description:"The resource assignment has been removed."})}catch(s){console.error("Error deleting assignment:",s),l({title:"Error",description:"Failed to delete assignment. Please try again.",variant:"destructive"})}},children:"Delete Assignment"})})]})]})})})]})}export{Js as default};
