import{u as k,r as l,m as C,n as L,j as e,B as n,L as F,i as S}from"./index-BJDVYPr2.js";import{I as h}from"./input-C744jVRX.js";import{u as P,F as I,a as g,b,c as p,d as j,e as f,z as c,t as R}from"./form-Bn3qej8w.js";import{A as T}from"./arrow-left-CJqe-HNu.js";import"./label-DKKVfa8V.js";const A=c.object({username:c.string().min(2,"Username must be at least 2 characters"),password:c.string().min(6,"Password must be at least 6 characters")});function U(){const{login:y,user:m}=k(),[d,u]=l.useState(!1),[,a]=C(),{toast:x}=L(),[N,w]=l.useState(!0),i=P({resolver:R(A),defaultValues:{username:"",password:""}});l.useEffect(()=>{const r=setTimeout(()=>{w(!1)},1e3);return m&&a("/dashboard"),()=>clearTimeout(r)},[m,a]);async function v(r){u(!0);try{console.log("Attempting mobile login for user:",r.username),await y(r.username,r.password,!0),x({title:"Login Successful",description:"Redirecting to your dashboard..."})}catch(o){console.error("Mobile login error:",o);let t="An error occurred. Please try again.";if(o.message){const s=o.message;s.includes("401")||s.includes("unauthorized")||s.includes("invalid credentials")?t="Your username or password is incorrect. Please try again.":s.includes("network")||s.includes("fetch")?t="Network error. Please check your internet connection and try again.":s.includes("timeout")?t="The request timed out. Please try again.":s.includes("cookie")?t="Cookie error. Please try clearing your browser cookies and try again.":t=s.length>100?s.substring(0,100)+"...":s}x({title:"Login Failed",description:t,variant:"destructive"})}finally{u(!1)}}return N?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gradient-to-b from-white to-blue-50",children:e.jsxs("div",{className:"w-full max-w-md mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-primary",children:"ResilienceHub"}),e.jsx("p",{className:"text-lg text-neutral-700",children:"Mobile-Friendly Login"}),e.jsx(n,{asChild:!0,variant:"outline",size:"sm",className:"mt-2",children:e.jsxs(F,{href:"/",children:[e.jsx(T,{className:"mr-2 h-4 w-4"})," View Landing Page"]})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-blue-800",children:"Welcome to ResilienceHub - your personal CBT interactive tool for tracking emotional wellbeing and personal development."})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md border border-gray-100 p-6",children:e.jsx(I,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(v),className:"space-y-5",children:[e.jsx(g,{control:i.control,name:"username",render:({field:r})=>e.jsxs(b,{children:[e.jsx(p,{className:"text-base",children:"Username or Email"}),e.jsx(j,{children:e.jsx(h,{placeholder:"Enter your username or email",autoComplete:"username",className:"h-11 text-base",...r})}),e.jsx(f,{})]})}),e.jsx(g,{control:i.control,name:"password",render:({field:r})=>e.jsxs(b,{children:[e.jsx(p,{className:"text-base",children:"Password"}),e.jsx(j,{children:e.jsx(h,{type:"password",placeholder:"Enter your password",autoComplete:"current-password",className:"h-11 text-base",...r})}),e.jsx(f,{})]})}),e.jsx(n,{type:"submit",className:"w-full h-11 text-base font-medium mt-2",disabled:d,children:d?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(S,{className:"mr-2 h-5 w-5 animate-spin"}),"Signing In..."]}):"Sign In"})]})})}),e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("p",{className:"text-sm text-neutral-600",children:"Having trouble signing in? Try to:"}),e.jsxs("ul",{className:"text-sm text-neutral-600 mt-2 space-y-1",children:[e.jsx("li",{children:"• Check that your username and password are correct"}),e.jsx("li",{children:"• Clear your browser cookies and try again"}),e.jsx("li",{children:"• Use a different browser if possible"})]})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsxs("p",{className:"text-sm text-neutral-600",children:["Don't have an account?"," ",e.jsx(n,{variant:"link",className:"p-0 font-medium",onClick:()=>a("/auth"),children:"Register here"})]})}),e.jsx("div",{className:"text-center mt-3",children:e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>a("/"),children:"Return to home page"})}),e.jsx("div",{className:"text-center mt-6",children:e.jsxs("p",{className:"text-xs text-neutral-500",children:["ResilienceHub - A tool for tracking progress with CBT techniques",e.jsx("br",{}),"Need help? Contact support at",e.jsx("br",{}),e.jsx("a",{href:"mailto:mail@resiliencec.com",className:"text-primary",children:"mail@resiliencec.com"})]})})]})})}export{U as default};
