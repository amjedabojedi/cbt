import{r as A,j as e,C as l,e as r,f as c,g as o,a as m,A as z,o as P,p as U,L as J,u as G,B as O}from"./index-BJDVYPr2.js";import{u as E}from"./useQuery-CVl6tFXz.js";import{I as X}from"./input-C744jVRX.js";import{B as y}from"./Header-HmO9KIvP.js";import{A as Y,a as Z,b as _,c as I}from"./accordion-C_vhZxL6.js";import{T as Q,a as W,b as T,c as L}from"./tabs-DZkkmdmK.js";import{S as k}from"./skeleton-BOSe4yaW.js";import{H as S}from"./target-7abParum.js";import{I as ee}from"./info-PLI2XuV7.js";import{C as q}from"./calendar-Ck4F2mgv.js";import{A as se}from"./AppLayout-B4pR-pjA.js";import{S as ae}from"./search-BLKRXzl6.js";import{L as te}from"./link-D4lgC82f.js";import"./utils-km2FGkQ4.js";import"./index-ZMpGrT0S.js";import"./index-epKMAjhH.js";import"./check-CPyQFfyd.js";import"./chevron-down-JR_7gpC-.js";function ie({journalEntryId:t,emotion:i,userId:u}){var F,$,D,K,H,V;const[n,f]=A.useState("emotions"),{data:h,isLoading:w,error:d}=E({queryKey:["/api/users",u,"journal",t,"related-emotions"],enabled:!!t}),{data:j,isLoading:x,error:g}=E({queryKey:["/api/users",u,"emotions",i,"related-journal"],enabled:!!i}),{data:p,isLoading:C,error:N}=E({queryKey:["/api/users",u,"emotions",i,"related-thoughts"],enabled:!!i});A.useEffect(()=>{t?f("emotions"):i&&f("journal")},[t,i]);const a=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}),v=((F=h==null?void 0:h.relatedEmotions)==null?void 0:F.length)>0,B=(($=j==null?void 0:j.relatedEntries)==null?void 0:$.length)>0,M=((D=p==null?void 0:p.relatedThoughts)==null?void 0:D.length)>0;return!w&&!x&&!C&&!v&&!B&&!M?e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(c,{className:"text-lg flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-primary"}),t?"Related Emotions":"Related Content"]}),e.jsx(o,{children:t?"No related emotions found for this journal entry.":"No related content found for this emotion."})]}),e.jsx(m,{children:e.jsxs(z,{children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx(P,{children:"No connections found"}),e.jsx(U,{children:t?"Try adding more emotion tags to this journal entry.":"Try recording more emotions or journal entries."})]})})]}):w||x||C?e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(c,{className:"text-lg flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-primary"}),t?"Related Emotions":"Related Content"]}),e.jsx(o,{children:"Loading related content..."})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsx(k,{className:"h-20 w-full"}),e.jsx(k,{className:"h-20 w-full"}),e.jsx(k,{className:"h-20 w-full"})]})]}):d||g||N?e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(c,{className:"text-lg flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-primary"}),t?"Related Emotions":"Related Content"]}),e.jsx(o,{children:"An error occurred while loading related content."})]}),e.jsx(m,{children:e.jsxs(z,{variant:"destructive",children:[e.jsx(P,{children:"Error"}),e.jsx(U,{children:(d==null?void 0:d.message)||(g==null?void 0:g.message)||(N==null?void 0:N.message)||"Unknown error"})]})})]}):e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(c,{className:"text-lg flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-primary"}),t?"Related Emotions":i?`Content Related to "${i}"`:"Related Content"]}),e.jsx(o,{children:t?"Showing emotions related to the tags in this entry.":`Showing content related to the emotion "${i}".`})]}),e.jsx(m,{children:e.jsxs(Q,{value:n,onValueChange:f,children:[e.jsxs(W,{className:"w-full mb-4",children:[t&&v&&e.jsx(T,{value:"emotions",children:"Emotions"}),i&&B&&e.jsx(T,{value:"journal",children:"Journal Entries"}),i&&M&&e.jsx(T,{value:"thoughts",children:"Thought Records"})]}),t&&e.jsx(L,{value:"emotions",className:"space-y-4",children:(K=h==null?void 0:h.relatedEmotions)==null?void 0:K.map(s=>e.jsxs(l,{className:"border-l-4",style:{borderLeftColor:ne(s.coreEmotion)},children:[e.jsxs(r,{className:"p-4 pb-2",children:[e.jsxs(c,{className:"text-base",children:[s.tertiaryEmotion,e.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(",s.intensity,"/10)"]})]}),e.jsxs(o,{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-3 w-3"})," ",a(s.timestamp)]})]}),e.jsxs(m,{className:"p-4 pt-0",children:[e.jsx("p",{className:"text-sm mb-2 line-clamp-2",children:s.situation}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.matchingEmotions.map(b=>e.jsx(y,{variant:"outline",className:"bg-primary/10",children:b},b))})]})]},s.id))}),i&&e.jsx(L,{value:"journal",className:"space-y-4",children:(H=j==null?void 0:j.relatedEntries)==null?void 0:H.map(s=>{var b;return e.jsxs(l,{className:"hover:bg-accent/50 transition-colors",children:[e.jsxs(r,{className:"p-4 pb-2",children:[e.jsx(J,{href:`/journal/${s.id}`,children:e.jsx(c,{className:"text-base hover:underline cursor-pointer",children:s.title})}),e.jsxs(o,{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-3 w-3"})," ",a(s.timestamp)]})]}),e.jsx(m,{className:"p-4 pt-0",children:e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:(b=s.userSelectedTags)==null?void 0:b.map(R=>e.jsx(y,{variant:s.matchingEmotions.includes(R)?"default":"outline",className:s.matchingEmotions.includes(R)?"":"bg-muted/50",children:R},R))})})]},s.id)})}),i&&e.jsx(L,{value:"thoughts",className:"space-y-4",children:(V=p==null?void 0:p.relatedThoughts)==null?void 0:V.map(s=>e.jsxs(l,{className:"hover:bg-accent/50 transition-colors",children:[e.jsxs(r,{className:"p-4 pb-2",children:[e.jsx(J,{href:`/thoughts/${s.id}`,children:e.jsx(c,{className:"text-base hover:underline cursor-pointer",children:s.situation.length>60?s.situation.substring(0,60)+"...":s.situation})}),e.jsxs(o,{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-3 w-3"})," ",a(s.timestamp)]})]}),e.jsxs(m,{className:"p-4 pt-0",children:[e.jsx("p",{className:"text-sm mb-2 line-clamp-2",children:s.automaticThought}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(y,{children:s.emotion}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Intensity: ",s.emotionIntensity,"/10"]})]})]})]},s.id))})]})})]})}function ne(t){const i={Joy:"#F9D71C",Sadness:"#6D87C4",Fear:"#8A65AA",Disgust:"#7DB954",Anger:"#E43D40",Love:"#E6338F",Surprise:"#6B46C1",default:"#888888"};return i[t]||i.default}function Ce(){const{user:t}=G(),[i,u]=A.useState(""),[n,f]=A.useState(""),[h,w]=A.useState("taxonomy"),{data:d,isLoading:j}=E({queryKey:["/api/emotions/taxonomy"]}),{data:x,isLoading:g}=E({queryKey:["/api/emotions/related",n],enabled:!!n}),p=a=>{a.preventDefault(),i&&f(i)},C=a=>{f(a),u(a),w("related")};if(!t)return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx(l,{className:"w-full max-w-md",children:e.jsxs(r,{children:[e.jsx(c,{children:"Authentication Required"}),e.jsx(o,{children:"Please log in to access this feature."})]})})});if(t.role!=="admin")return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx(l,{className:"w-full max-w-md",children:e.jsxs(r,{children:[e.jsx(c,{children:"Admin Access Required"}),e.jsx(o,{children:"This feature is only available to administrators."})]})})});const N=e.jsxs("div",{className:"container py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Emotion Mapping & Integration"}),e.jsx("p",{className:"text-muted-foreground",children:"Admin configuration tool to manage emotion taxonomy and connections across the application."}),e.jsxs("div",{className:"flex items-center mt-2 bg-amber-50 border border-amber-200 p-3 rounded-md",children:[e.jsx("div",{className:"text-amber-600 mr-2",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-shield-alert",children:[e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),e.jsx("path",{d:"M12 8v4"}),e.jsx("path",{d:"M12 16h.01"})]})}),e.jsx("div",{className:"text-sm text-amber-800",children:"Changes made here will affect emotion relationships throughout the entire application."})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(l,{className:"md:col-span-2",children:[e.jsxs(r,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"Search Emotions"]}),e.jsx(o,{children:"Search for an emotion to see its classification and related content."})]}),e.jsx(m,{children:e.jsxs("form",{onSubmit:p,className:"flex gap-2",children:[e.jsx(X,{placeholder:"Type an emotion (e.g., anxiety, joy, frustration)",value:i,onChange:a=>u(a.target.value),className:"flex-1"}),e.jsx(O,{type:"submit",children:"Search"})]})})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs(Q,{value:h,onValueChange:w,children:[e.jsxs(W,{className:"w-full",children:[e.jsx(T,{value:"taxonomy",children:"Emotion Taxonomy"}),e.jsx(T,{value:"related",disabled:!n,children:"Related Emotions"})]}),e.jsx(L,{value:"taxonomy",className:"space-y-4 mt-4",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-primary"}),"Emotion Classification"]}),e.jsx(o,{children:"All emotions are organized into families based on core emotions."})]}),e.jsx(m,{children:j?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsx(Y,{type:"single",collapsible:!0,className:"w-full",children:d&&d.coreEmotions?d.coreEmotions.map(a=>e.jsxs(Z,{value:a,children:[e.jsx(_,{className:"text-lg font-medium",children:a}),e.jsx(I,{children:e.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:d.emotionFamilies&&d.emotionFamilies[a]?d.emotionFamilies[a].map(v=>e.jsx(y,{variant:"outline",className:"cursor-pointer hover:bg-accent",onClick:()=>C(v),children:v},v)):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No emotion variants found."})})})]},a)):e.jsx("p",{className:"text-sm text-muted-foreground py-4",children:"No emotion data available."})})})]})}),e.jsx(L,{value:"related",className:"space-y-4 mt-4",children:n&&e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5 text-primary"}),"Emotion Relationships"]}),e.jsxs(o,{children:['Showing emotions related to "',n,'"']})]}),e.jsx(m,{children:g?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Core Emotion:"}),e.jsx(y,{variant:"default",className:"text-base py-1.5",children:x==null?void 0:x.coreEmotion})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Related Emotions:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x&&x.relatedEmotions?x.relatedEmotions.map(a=>e.jsx(y,{variant:a===n?"default":"outline",className:`${a===n?"ring-2 ring-offset-1":"hover:bg-accent cursor-pointer"}`,onClick:()=>a!==n&&C(a),children:a},a)):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No related emotions found."})})]})]})})]})})]})}),e.jsx("div",{children:n&&(t==null?void 0:t.id)&&e.jsx(ie,{emotion:n,userId:t.id})})]})]});return e.jsx(se,{title:"Emotion Mapping & Integration",children:N})}export{Ce as default};
