import{r as c,n as E,h as o,j as e,i as C,B as m,C as p,e as R,f as S,a as j}from"./index-BJDVYPr2.js";import{o as k,B as N,p as A}from"./Header-HmO9KIvP.js";import{T as B,a as L,b as x,c as D}from"./tabs-DZkkmdmK.js";import{A as g}from"./AppLayout-B4pR-pjA.js";import{f as F}from"./formatDistanceToNow-3rPklNTy.js";import{E as $}from"./eye-D3NTB46B.js";import{T as z}from"./trash-2-ZtlY59XR.js";import"./target-7abParum.js";import"./index-ZMpGrT0S.js";import"./index-epKMAjhH.js";import"./check-CPyQFfyd.js";import"./en-US-9SRVm7yB.js";import"./endOfMonth-93QfFfxB.js";function W(){const[t,l]=c.useState([]),[v,u]=c.useState(!0),[d,y]=c.useState("all"),{toast:r}=E();c.useEffect(()=>{h()},[]);async function h(){try{u(!0);const s=await o("GET","/api/admin/notifications");if(s.ok){const a=await s.json();l(a)}}catch(s){console.error("Error fetching notifications:",s),r({title:"Error",description:"Failed to fetch notifications",variant:"destructive"})}finally{u(!1)}}async function b(s){try{(await o("POST",`/api/notifications/read/${s}`)).ok&&(l(t.map(i=>i.id===s?{...i,isRead:!0}:i)),r({title:"Success",description:"Notification marked as read"}))}catch(a){console.error("Error marking notification as read:",a),r({title:"Error",description:"Failed to mark notification as read",variant:"destructive"})}}async function w(s){try{(await o("DELETE",`/api/notifications/${s}`)).ok&&(l(t.filter(i=>i.id!==s)),r({title:"Success",description:"Notification deleted"}))}catch(a){console.error("Error deleting notification:",a),r({title:"Error",description:"Failed to delete notification",variant:"destructive"})}}function T(s){switch(s){case"reminder":return"bg-blue-100 text-blue-800";case"alert":return"bg-red-100 text-red-800";case"system":return"bg-gray-100 text-gray-800";case"therapist_message":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}const f=t.filter(s=>{switch(d){case"unread":return!s.isRead;case"read":return s.isRead;default:return!0}}),n=t.filter(s=>!s.isRead).length;return v?e.jsx(g,{title:"System Notifications",children:e.jsx("div",{className:"flex items-center justify-center min-h-[500px]",children:e.jsx(C,{className:"h-8 w-8 animate-spin text-primary"})})}):e.jsx(g,{title:"System Notifications",children:e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(k,{className:"h-6 w-6"}),"System Notifications"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage system-wide notifications and alerts"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(m,{onClick:h,variant:"outline",children:"Refresh"})})]}),e.jsxs(p,{children:[e.jsx(R,{children:e.jsxs(S,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["Notifications (",t.length,")"]}),n>0&&e.jsxs(N,{variant:"destructive",children:[n," unread"]})]})}),e.jsx(j,{children:e.jsxs(B,{value:d,onValueChange:y,children:[e.jsxs(L,{className:"grid w-full grid-cols-3",children:[e.jsxs(x,{value:"all",children:["All (",t.length,")"]}),e.jsxs(x,{value:"unread",children:["Unread (",n,")"]}),e.jsxs(x,{value:"read",children:["Read (",t.length-n,")"]})]}),e.jsx(D,{value:d,className:"mt-4",children:e.jsx(A,{className:"h-[600px]",children:f.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No notifications found"}):e.jsx("div",{className:"space-y-3",children:f.map(s=>e.jsx(p,{className:`${s.isRead?"":"border-l-4 border-l-blue-500"}`,children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-medium",children:s.title}),e.jsx(N,{variant:"secondary",className:T(s.type),children:s.type}),!s.isRead&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.body}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsx("span",{children:F(new Date(s.createdAt),{addSuffix:!0})}),s.userName&&e.jsxs("span",{children:["User: ",s.userName]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[!s.isRead&&e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>b(s.id),className:"h-8 w-8 p-0",children:e.jsx($,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>w(s.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:e.jsx(z,{className:"h-4 w-4"})})]})]})})},s.id))})})})]})})]})]})})}export{W as default};
