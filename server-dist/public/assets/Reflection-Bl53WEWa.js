import{u as A,n as b,m as I,r as s,j as e,i as k,B as l,C as p,e as x,f as g,g as f,a as B}from"./index-BJDVYPr2.js";import{u as j}from"./useQuery-CVl6tFXz.js";import{A as u}from"./AppLayout-B4pR-pjA.js";import{u as S}from"./use-active-user-CkIppDip.js";import{R as U}from"./ReflectionWizard-ChKYTux2.js";import{C as y}from"./chevron-left-DkowiYxd.js";import{B as q}from"./brain-circuit-ClF974iG.js";import"./utils-km2FGkQ4.js";import"./Header-HmO9KIvP.js";import"./target-7abParum.js";import"./index-ZMpGrT0S.js";import"./index-epKMAjhH.js";import"./check-CPyQFfyd.js";import"./form-Bn3qej8w.js";import"./label-DKKVfa8V.js";import"./dialog-BkbRhY2O.js";import"./textarea-8UmQ7iuL.js";import"./input-C744jVRX.js";import"./checkbox-CpzJVwUi.js";import"./index-pLghM4Oe.js";import"./progress-XD4z056s.js";import"./slider-BHLSMB0K.js";import"./info-PLI2XuV7.js";import"./accordion-C_vhZxL6.js";import"./chevron-down-JR_7gpC-.js";import"./circle-plus-C1yyTLEf.js";function de(){A();const{activeUserId:r}=S(),{toast:c}=b(),[K,t]=I(),[n,R]=s.useState(null),[o,v]=s.useState(null),[m,N]=s.useState(null),[C,T]=s.useState(!0);s.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("edit");a?R(parseInt(a,10)):(t("/thoughts"),c({title:"No record selected",description:"Please select a thought record to edit."}))},[t,c]);const{data:d,isLoading:E}=j({queryKey:r&&n?[`/api/users/${r}/thoughts`]:[],enabled:!!(r&&n)});s.useEffect(()=>{if(d&&Array.isArray(d)&&n){const i=d.find(a=>a.id===n);i?v(i):(c({title:"Record not found",description:"The thought record you're trying to edit was not found.",variant:"destructive"}),t("/thoughts"))}},[d,n,c,t]);const{data:h,isLoading:L}=j({queryKey:r?[`/api/users/${r}/emotions`]:[],enabled:!!(r&&o)});s.useEffect(()=>{if(h&&Array.isArray(h)&&o&&o.emotionRecordId){const i=h.find(a=>a.id===o.emotionRecordId);i&&N(i),T(!1)}},[h,o]);const w=()=>{t("/thoughts")};return C||E||L?e.jsx(u,{title:"Edit Thought Record",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[70vh]",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(k,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading thought record..."})]})})})}):!o||!m?e.jsx(u,{title:"Edit Thought Record",children:e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs(l,{variant:"outline",onClick:()=>t("/thoughts"),className:"mb-4",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Back to Thought Records"]}),e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(g,{children:"Record Not Found"}),e.jsx(f,{children:"The thought record you're trying to edit could not be found."})]}),e.jsxs(B,{children:[e.jsx("p",{children:"The record may have been deleted or you may not have permission to view it."}),e.jsx(l,{className:"mt-4",onClick:()=>t("/thoughts"),children:"Return to Thought Records"})]})]})]})}):e.jsx(u,{title:"Edit Thought Record",children:e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs(l,{variant:"outline",onClick:()=>t("/thoughts"),className:"mb-4",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Back to Thought Records"]}),e.jsx(p,{className:"mb-6",children:e.jsxs(x,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-primary"}),"Edit Thought Record"]}),e.jsx(f,{children:"Make changes to your thought record and save when finished"})]})}),m&&o&&e.jsx(U,{emotion:m,open:!0,onClose:w,existingThoughtRecord:o,isEditMode:!0})]})})}export{de as default};
