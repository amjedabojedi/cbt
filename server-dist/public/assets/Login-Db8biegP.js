import{c as k,z as C,j as e,C as j,e as w,f as b,W as E,a as v,l as T,B as m,u as A,m as F,r as i,n as I,L as f,g as P,h as M}from"./index-BJDVYPr2.js";import{I as g}from"./input-C744jVRX.js";import{T as S}from"./triangle-alert-B6ZFxm6X.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=k("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),W=({error:a,resetError:n,title:l="Connection Error",description:c="There was a problem connecting to the server"})=>{C();const r=typeof a=="string"?a:(a==null?void 0:a.message)||"Unable to connect to the server",t=r.includes("401")||r.toLowerCase().includes("unauthorized")||r.toLowerCase().includes("invalid credentials");return e.jsxs(j,{className:"w-full max-w-md mx-auto shadow-lg border-destructive/30 animate-in fade-in-50 duration-300",children:[e.jsx(w,{className:"pb-2 bg-destructive/10",children:e.jsxs(b,{className:"flex items-center text-lg gap-2",children:[t?e.jsx(S,{className:"h-5 w-5 text-destructive"}):e.jsx(E,{className:"h-5 w-5 text-destructive"}),t?"Authentication Error":l]})}),e.jsxs(v,{className:"pb-3 pt-4",children:[e.jsx("p",{className:"text-sm text-foreground mb-3",children:t?"Your login credentials appear to be incorrect.":c}),t&&e.jsxs("div",{className:"bg-muted p-3 rounded-md text-xs mb-3",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Please try these credentials:"}),e.jsxs("p",{children:["• Admin: username: ",e.jsx("span",{className:"font-mono",children:"admin"}),", password: ",e.jsx("span",{className:"font-mono",children:"123456"})]}),e.jsxs("p",{children:["• Therapist: username: ",e.jsx("span",{className:"font-mono",children:"lcanady"}),", password: ",e.jsx("span",{className:"font-mono",children:"123456"})]})]}),!1,!navigator.onLine&&e.jsxs("div",{className:"flex items-center gap-2 mt-3 p-3 bg-amber-100 dark:bg-amber-950/30 rounded-md",children:[e.jsx(z,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),e.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-400",children:"Your device appears to be offline. Please check your internet connection."})]})]}),n&&e.jsx(T,{className:"pt-0",children:e.jsx(m,{variant:"default",size:"sm",onClick:n,className:"w-full",children:t?"Try Again":"Retry Connection"})})]})};function H(){const{user:a}=A(),[,n]=F(),[l,c]=i.useState(""),[r,t]=i.useState(""),[u,h]=i.useState(!1),[x,d]=i.useState(null),{toast:p}=I();i.useEffect(()=>{a&&n("/")},[a,n]);const N=async o=>{o.preventDefault(),h(!0);try{d(null);const L=await(await M("POST","/api/auth/login",{username:l,password:r})).json();console.log("Login successful, user data:",L),window.location.href="/dashboard"}catch(s){console.error("Login error:",s),d(s instanceof Error?s:new Error("Failed to log in")),s instanceof Error&&(s.message.includes("Invalid credentials")||s.message.includes("401"))?p({title:"Invalid Credentials",description:"The username or password you entered is incorrect. Please check your credentials and try again.",variant:"destructive"}):p({title:"Login Error",description:s instanceof Error?s.message:"Failed to log in. Please try again.",variant:"destructive"})}finally{h(!1)}},y=()=>{d(null)};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(m,{asChild:!0,variant:"ghost",className:"flex items-center gap-2 text-muted-foreground",children:e.jsxs(f,{href:"/",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1",children:[e.jsx("path",{d:"m12 19-7-7 7-7"}),e.jsx("path",{d:"M19 12H5"})]}),"Back to Home"]})})}),x&&e.jsx("div",{className:"mb-6",children:e.jsx(W,{error:x,resetError:y,title:"Authentication Error",description:"There was a problem with your login attempt"})}),e.jsxs(j,{className:"w-full max-w-md",children:[e.jsxs(w,{children:[e.jsx(b,{children:"Log In"}),e.jsx(P,{children:"Enter your credentials to access your account"})]}),e.jsx(v,{children:e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"username",className:"text-sm font-medium",children:"Username or Email"}),e.jsx(g,{id:"username",type:"text",value:l,onChange:o=>c(o.target.value),placeholder:"johndoe or john@example.com",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"You can log in with either your username or email address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"password",className:"text-sm font-medium",children:"Password"}),e.jsx(f,{href:"/forgot-password",className:"text-xs text-blue-600 hover:text-blue-500",children:"Forgot password?"})]}),e.jsx(g,{id:"password",type:"password",value:r,onChange:o=>t(o.target.value),required:!0})]}),e.jsx("div",{className:"space-y-3 pt-2",children:e.jsx(m,{type:"submit",className:"w-full",disabled:u,children:u?"Logging in...":"Log In"})})]})})]})]})})}export{H as default};
