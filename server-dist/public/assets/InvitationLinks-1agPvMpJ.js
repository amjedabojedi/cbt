import{c as L,u as I,n as S,r as m,j as e,C as h,e as g,f as N,g as f,a as x,l as b,B as p,h as F}from"./index-BJDVYPr2.js";import{I as k}from"./input-C744jVRX.js";import{L as y}from"./label-DKKVfa8V.js";import{u as E}from"./useMutation-4_CoT2bx.js";import{L as C}from"./link-D4lgC82f.js";import{C as T}from"./check-CPyQFfyd.js";import{S as P}from"./send-D_NmVAMV.js";import"./utils-km2FGkQ4.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=L("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);function U(){const{user:l}=I(),{toast:t}=S(),[n,c]=m.useState([]),[r,u]=m.useState(""),[o,j]=m.useState(""),d=E({mutationFn:async s=>{const i=await F("POST","/api/users/invite-client",s);if(!i.ok){const a=await i.json();throw new Error(a.message||"Failed to create invitation")}return i.json()},onSuccess:s=>{const i={id:Date.now(),email:r,name:o,link:s.inviteLink||`${window.location.origin}/auth?invitation=true&email=${encodeURIComponent(r)}&therapistId=${l==null?void 0:l.id}`,copied:!1};c(a=>[...a,i]),u(""),j(""),t({title:"Invitation Link Created",description:`A link for ${o} has been created and is ready to share.`})},onError:s=>{t({title:"Error Creating Link",description:s.message||"Failed to create invitation link. Please try again.",variant:"destructive"})}}),v=s=>{if(s.preventDefault(),!r||!o){t({title:"Missing Information",description:"Please provide both email and name to create an invitation link.",variant:"destructive"});return}d.mutate({email:r,name:o})},w=s=>{const i=n.find(a=>a.id===s);i&&navigator.clipboard.writeText(i.link).then(()=>{c(n.map(a=>a.id===s?{...a,copied:!0}:a)),setTimeout(()=>{c(n.map(a=>a.id===s?{...a,copied:!1}:a))},2e3),t({title:"Link Copied",description:"The invitation link has been copied to your clipboard."})}).catch(a=>{t({title:"Copy Failed",description:"Unable to copy the link. Please try again.",variant:"destructive"})})};return e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Create Invitation Links"}),e.jsxs(h,{className:"mb-8",children:[e.jsxs(g,{children:[e.jsx(N,{children:"Generate New Invitation Link"}),e.jsx(f,{children:"Create a personalized invitation link for someone to join Resilience CBT."})]}),e.jsx(x,{children:e.jsx("form",{onSubmit:v,className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"email",children:"Email"}),e.jsx(k,{id:"email",type:"email",placeholder:"client@example.com",value:r,onChange:s=>u(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"name",children:"Name"}),e.jsx(k,{id:"name",placeholder:"John Doe",value:o,onChange:s=>j(s.target.value),required:!0})]})]})})}),e.jsx(b,{children:e.jsx(p,{onClick:v,disabled:d.isPending,children:d.isPending?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Generating..."]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Generate Link"]})})})]}),e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Your Invitation Links"}),n.length===0?e.jsx(h,{className:"bg-blue-50 border-blue-200 border",children:e.jsxs(x,{className:"pt-6 text-center",children:[e.jsx(C,{className:"mx-auto h-12 w-12 text-blue-500 mb-4"}),e.jsx("p",{className:"text-blue-800",children:"No invitation links generated yet. Create your first link above."})]})}):e.jsx("div",{className:"space-y-4",children:n.map(s=>e.jsxs(h,{className:"border-l-4 border-l-primary",children:[e.jsxs(g,{children:[e.jsxs(N,{className:"flex justify-between items-center",children:[e.jsx("span",{children:s.name}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>w(s.id),className:"h-8 gap-1",children:s.copied?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-green-500",children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{children:"Copy"})]})})]}),e.jsx(f,{children:s.email})]}),e.jsx(x,{className:"pb-2",children:e.jsx("div",{className:"bg-blue-50 rounded p-3 text-sm font-mono break-all",children:s.link})}),e.jsxs(b,{className:"justify-between",children:[e.jsxs("div",{className:"text-xs text-neutral-500",children:["Generated ",new Date().toLocaleString()]}),e.jsxs(p,{variant:"outline",size:"sm",className:"gap-1",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{children:"Send via Email"})]})]})]},s.id))})]})}export{U as default};
