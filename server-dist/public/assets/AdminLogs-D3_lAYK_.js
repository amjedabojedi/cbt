import{r,n as _,h as u,j as e,i as w,B as m,C as x,e as T,f as L,a as h}from"./index-BJDVYPr2.js";import{p as C,B as A}from"./Header-HmO9KIvP.js";import{T as E,a as S,b as a,c as k}from"./tabs-DZkkmdmK.js";import{A as p}from"./AppLayout-B4pR-pjA.js";import{F as f}from"./file-text-CB9D2AC_.js";import{T as B}from"./triangle-alert-B6ZFxm6X.js";import{T as D}from"./trash-2-ZtlY59XR.js";import{U as F}from"./user-hKahD6_k.js";import{f as U}from"./formatDistanceToNow-3rPklNTy.js";import"./target-7abParum.js";import"./index-ZMpGrT0S.js";import"./index-epKMAjhH.js";import"./check-CPyQFfyd.js";import"./en-US-9SRVm7yB.js";import"./endOfMonth-93QfFfxB.js";function Y(){const[t,c]=r.useState([]),[g,l]=r.useState(!0),[i,j]=r.useState("all"),{toast:n}=_();r.useEffect(()=>{o()},[]);async function o(){try{l(!0);const s=await u("GET","/api/admin/logs");if(s.ok){const b=await s.json();c(b)}}catch(s){console.error("Error fetching logs:",s),n({title:"Error",description:"Failed to fetch system logs",variant:"destructive"})}finally{l(!1)}}async function y(){try{(await u("DELETE","/api/admin/logs")).ok&&(c([]),n({title:"Success",description:"System logs cleared"}))}catch(s){console.error("Error clearing logs:",s),n({title:"Error",description:"Failed to clear logs",variant:"destructive"})}}function v(s){switch(s){case"user_created":case"user_updated":return e.jsx(F,{className:"h-4 w-4"});case"user_deleted":return e.jsx(D,{className:"h-4 w-4"});case"system_error":return e.jsx(B,{className:"h-4 w-4"});default:return e.jsx(f,{className:"h-4 w-4"})}}function N(s){switch(s){case"user_created":return"bg-green-100 text-green-800";case"user_updated":return"bg-blue-100 text-blue-800";case"user_deleted":return"bg-red-100 text-red-800";case"system_error":return"bg-red-100 text-red-800";case"login":return"bg-blue-100 text-blue-800";case"logout":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}const d=t.filter(s=>{switch(i){case"user_actions":return["user_created","user_updated","user_deleted","login","logout"].includes(s.action);case"system_events":return["system_error","system_startup","system_shutdown"].includes(s.action);case"errors":return s.action.includes("error");default:return!0}});return g?e.jsx(p,{title:"System Logs",children:e.jsx("div",{className:"flex items-center justify-center min-h-[500px]",children:e.jsx(w,{className:"h-8 w-8 animate-spin text-primary"})})}):e.jsx(p,{title:"System Logs",children:e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(f,{className:"h-6 w-6"}),"System Logs"]}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor system activities and user actions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{onClick:y,variant:"destructive",disabled:t.length===0,children:"Clear Logs"}),e.jsx(m,{onClick:o,variant:"outline",children:"Refresh"})]})]}),e.jsxs(x,{children:[e.jsx(T,{children:e.jsxs(L,{children:["Activity Log (",t.length," entries)"]})}),e.jsx(h,{children:e.jsxs(E,{value:i,onValueChange:j,children:[e.jsxs(S,{className:"grid w-full grid-cols-4",children:[e.jsxs(a,{value:"all",children:["All (",t.length,")"]}),e.jsxs(a,{value:"user_actions",children:["User Actions (",t.filter(s=>["user_created","user_updated","user_deleted","login","logout"].includes(s.action)).length,")"]}),e.jsxs(a,{value:"system_events",children:["System Events (",t.filter(s=>["system_error","system_startup","system_shutdown"].includes(s.action)).length,")"]}),e.jsxs(a,{value:"errors",children:["Errors (",t.filter(s=>s.action.includes("error")).length,")"]})]}),e.jsx(k,{value:i,className:"mt-4",children:e.jsx(C,{className:"h-[600px]",children:d.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No logs found for this category"}):e.jsx("div",{className:"space-y-3",children:d.map(s=>e.jsx(x,{className:"border-l-4 border-l-gray-300",children:e.jsx(h,{className:"p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[v(s.action),e.jsx("h4",{className:"font-medium",children:s.action.replace(/_/g," ").toUpperCase()}),e.jsx(A,{variant:"secondary",className:N(s.action),children:s.action})]}),s.details&&Object.keys(s.details).length>0&&e.jsxs("div",{className:"bg-gray-50 rounded p-3 mb-2",children:[e.jsx("h5",{className:"text-sm font-medium mb-1",children:"Details:"}),e.jsx("pre",{className:"text-xs text-muted-foreground whitespace-pre-wrap",children:JSON.stringify(s.details,null,2)})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsx("span",{children:U(new Date(s.timestamp),{addSuffix:!0})}),s.performerName&&e.jsxs("span",{children:["By: ",s.performerName]}),s.ipAddress&&e.jsxs("span",{children:["IP: ",s.ipAddress]})]})]})})})},s.id))})})})]})})]})]})})}export{Y as default};
