  // Handle selection of core emotion
  const handleCoreSelect = (emotionName: string) => {
    setSelectedCore(emotionName);
    setSelectedPrimary(null);
    setSelectedTertiary(null);
  };

  // Handle selection of primary emotion
  const handlePrimarySelect = (emotionName: string) => {
    setSelectedPrimary(emotionName);
    setSelectedTertiary(null);
  };

  // Handle selection of tertiary emotion
  const handleTertiarySelect = (emotionName: string) => {
    setSelectedTertiary(emotionName);
    
    if (selectedCore && selectedPrimary && onEmotionSelect) {
      onEmotionSelect({
        coreEmotion: selectedCore,
        primaryEmotion: selectedPrimary,
        tertiaryEmotion: emotionName,
      });
    }
  };

  // Reset all selections
  const resetSelections = () => {
    setSelectedCore(null);
    setSelectedPrimary(null);
    setSelectedTertiary(null);
  };

  return (
    <div className="w-full max-w-md mx-auto">
      {/* Breadcrumb Trail */}
      <div id="emotion-breadcrumb" className="breadcrumb-container bg-neutral-100 p-3 rounded-md mb-4 flex items-center">
        <span className="breadcrumb-label text-sm text-neutral-600 mr-2">
          {translate("Emotion Path:")}
        </span>
        <div className={`breadcrumb-trail flex ${direction === "rtl" ? "flex-row-reverse" : ""}`}>
          <span
            id="core-breadcrumb"
            className={cn(
              "breadcrumb-item bg-white text-sm py-1 px-2 border border-neutral-300 rounded relative",
              direction === "rtl" ? "ml-3" : "mr-3",
              !selectedCore ? "hidden" : ""
            )}
          >
            {selectedCore && translate(selectedCore)}
          </span>
          <span
            id="primary-breadcrumb"
            className={cn(
              "breadcrumb-item bg-white text-sm py-1 px-2 border border-neutral-300 rounded relative",
              direction === "rtl" ? "ml-3" : "mr-3",
              !selectedPrimary ? "hidden" : ""
            )}
          >
            {selectedPrimary && translate(selectedPrimary)}
          </span>
          <span
            id="tertiary-breadcrumb"
            className={cn(
              "breadcrumb-item bg-white text-sm py-1 px-2 border border-neutral-300 rounded",
              !selectedTertiary ? "hidden" : ""
            )}
          >
            {selectedTertiary && translate(selectedTertiary)}
          </span>
        </div>
      </div>

      {/* The SVG wheel */}
      <div
        id="emotional-wheel"
        className="wheel-container w-full aspect-square relative bg-gradient-to-b from-neutral-50 to-neutral-100 rounded-full shadow-md transition-transform duration-300 hover:scale-[1.02]"
      >
        <svg
          ref={svgRef}
          width="100%"
          height="100%"
          viewBox="0 0 400 400"
          className={cn("emotion-wheel", direction === "rtl" ? "rtl" : "")}
        >
          {generateWheel()}
        </svg>
      </div>

      {/* Hidden inputs for state */}
      <input type="hidden" id="selectedCore" name="selectedCore" value={selectedCore || ""} />
      <input type="hidden" id="selectedPrimary" name="selectedPrimary" value={selectedPrimary || ""} />
      <input type="hidden" id="selectedTertiary" name="selectedTertiary" value={selectedTertiary || ""} />
    </div>
  );
}
